<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Maximize dispersion for K groups — optimal_dispersion • anticlust</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Maximize dispersion for K groups — optimal_dispersion"><meta property="og:description" content="Maximize dispersion for K groups"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">anticlust</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.8.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Best_practices.html">Some best practices for anticlustering</a>
    </li>
    <li>
      <a href="../articles/Categorical_vars.html">Using categorical variables with anticlustering</a>
    </li>
    <li>
      <a href="../articles/Speeding_up_anticlustering.html">Speeding up anticlustering</a>
    </li>
    <li>
      <a href="../articles/stimulus-selection.html">Using the R package anticlust for stimulus selection in experiments</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="https://m-py.github.io/anticlust-blog" class="external-link">Blog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/m-Py/anticlust/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Maximize dispersion for K groups</h1>
    <small class="dont-index">Source: <a href="https://github.com/m-Py/anticlust/blob/HEAD/R/Optimal_Dispersion.R" class="external-link"><code>R/Optimal_Dispersion.R</code></a></small>
    <div class="hidden name"><code>optimal_dispersion.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Maximize dispersion for K groups</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">optimal_dispersion</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">K</span>,</span>
<span>  solver <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  max_dispersion_considered <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min_dispersion_considered <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  npartitions <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  time_limit <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>The data input. Can be one of two structures: (1) A
feature matrix where rows correspond to elements and columns
correspond to variables (a single numeric variable can be
passed as a vector). (2) An N x N matrix dissimilarity matrix;
can be an object of class <code>dist</code> (e.g., returned by
<code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code> or <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></code>) or a <code>matrix</code>
where the entries of the upper and lower triangular matrix
represent pairwise dissimilarities.</p></dd>


<dt id="arg-k">K<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>The number of groups or a vector describing the size of
each group.</p></dd>


<dt id="arg-solver">solver<a class="anchor" aria-label="anchor" href="#arg-solver"></a></dt>
<dd><p>Optional argument; currently supports "lpSolve",
"glpk", and "symphony". See <code><a href="optimal_anticlustering.html">optimal_anticlustering</a></code>.</p></dd>


<dt id="arg-max-dispersion-considered">max_dispersion_considered<a class="anchor" aria-label="anchor" href="#arg-max-dispersion-considered"></a></dt>
<dd><p>Optional argument used for early
stopping. If the dispersion found is equal to or exceeds this
value, a solution having the previous best dispersion is
returned.</p></dd>


<dt id="arg-min-dispersion-considered">min_dispersion_considered<a class="anchor" aria-label="anchor" href="#arg-min-dispersion-considered"></a></dt>
<dd><p>Optional argument used for
speeding up the algorithm computation.  If passed, the
dispersion is optimized starting from this value instead the
global minimum distance.</p></dd>


<dt id="arg-npartitions">npartitions<a class="anchor" aria-label="anchor" href="#arg-npartitions"></a></dt>
<dd><p>The number of groupings that are returned, each
having an optimal dispersion value (defaults to 1).</p></dd>


<dt id="arg-time-limit">time_limit<a class="anchor" aria-label="anchor" href="#arg-time-limit"></a></dt>
<dd><p>Time limit in seconds, given to the solver.
Default is there is no time limit.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list with four elements:</p>
<dl><dt>dispersion</dt>
<dd><p>The optimal dispersion</p></dd>

   <dt>groups</dt>
<dd><p>An assignment of elements to groups (vector)</p></dd>

   <dt>edges</dt>
<dd><p>A matrix of 2 columns. Each row contains the indices of
   elements that had to be investigated to find the dispersion (i.e., each pair
   of elements cannot be part of the same group in order to achieve maximum
   dispersion).</p></dd>

   <dt>dispersions_considered</dt>
<dd><p>All distances that were tested until the dispersion was found.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The dispersion is the minimum distance between two elements
  within the same group. This function implements an optimal method
  to maximize the dispersion. If the data input <code>x</code> is a
  feature matrix and not a dissimilarity matrix, the pairwise
  Euclidean distance is used. It uses the algorithm presented in
  Max Diekhoff's Bachelor thesis at the Computer Science Department
  at Heinrich Heine University Düsseldorf.</p>
<p>To find out which items are not allowed to be grouped in the same
  cluster for maximum dispersion, the algorithm sequentially builds
  instances of a graph coloring problem, using an integer linear
  programming (ILP) representation (also see Fernandez et al.,
  2013).  It is possible to specify the ILP solver via the argument
  <code>solver</code> (See <code><a href="optimal_anticlustering.html">optimal_anticlustering</a></code> for more
  information on this argument). Optimally solving the maximum
  dispersion problem is NP-hard for K &gt; 2 and therefore
  computationally infeasible for larger data sets. For K = 3 and K
  = 4, it seems that this approach scales up to several 100
  elements, or even &gt; 1000 for K = 3 (at least when using the
  Symphony solver).  For larger data sets, use the heuristic
  approaches in <code><a href="anticlustering.html">anticlustering</a></code> or
  <code><a href="bicriterion_anticlustering.html">bicriterion_anticlustering</a></code>. However, note that for
  K = 2, the optimal approach is usually much faster than the
  heuristics.</p>
<p>In the output, the element <code>edges</code> defines which elements
  must be in separate clusters in order to achieve maximum
  dispersion. All elements not listed here can be changed
  arbitrarily between clusters without reducing the dispersion.  If
  the maximum possible dispersion corresponds to the minimum
  dispersion in the data set, the output elements <code>edges</code> and
  <code>groups</code> are set to <code>NULL</code> because all possible
  groupings have the same value of dispersion.  In this case the
  output element <code>dispersions_considered</code> has length 1.</p>
<p>If a <code>time_limit</code> is set and the function cannot find in the optimal
  dispersion in the given time, it will throw an error.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>If the SYMPHONY solver is used, an unfortunate "message" is
    printed to the console when this function terminates:</p>
<p>sym_get_col_solution(): No solution has been stored!</p>
<p>This message is no reason to worry and instead is a direct result
of the algorithm finding the optimal value for the dispersion.
Unfortunately, this message is generated in the C code underlying
the SYMPHONY library (via the printing function <code>printf</code>),
which cannot be prevented in R.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Diekhoff (2023). Maximizing dispersion for anticlustering. Retrieved from
https://www.cs.hhu.de/fileadmin/redaktion/Fakultaeten/Mathematisch-Naturwissenschaftliche_Fakultaet/Informatik/Algorithmische_Bioinformatik/Bachelor-_Masterarbeiten/2831963_ba_ifo_AbschlArbeit_klau_mapap102_madie120_20230203_1815.pdf</p>
<p>Fernández, E., Kalcsics, J., &amp; Nickel, S. (2013). The maximum dispersion
problem. Omega, 41(4), 721–730. https://doi.org/10.1016/j.omega.2012.09.005</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="dispersion_objective.html">dispersion_objective</a></code> <code><a href="anticlustering.html">anticlustering</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Max Diekhoff</p>
<p>Martin Papenberg <a href="mailto:martin.papenberg@hhu.de">martin.papenberg@hhu.de</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">30</span></span></span>
<span class="r-in"><span><span class="va">M</span> <span class="op">&lt;-</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span><span class="op">*</span><span class="va">M</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="va">M</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">distances</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">opt</span> <span class="op">&lt;-</span> <span class="fu">optimal_dispersion</span><span class="op">(</span><span class="va">distances</span>, K <span class="op">=</span> <span class="va">K</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">opt</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dispersion</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.448638</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $groups</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 2 2 3 3 1 1 1 1 2 3 3 1 1 3 2 1 3 1 3 2 3 2 3 2 3 2 1 1 2 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $groups_fixated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  2  2 NA NA  1  1  1  1  2 NA NA  1  1  3  2  1 NA  1  3 NA NA  2 NA  2  3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26]  2  1  1  2 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $edges</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]   13   19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]    5   25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]   19   22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]    1    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]   13   24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]   15   18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]   13   26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]    1   25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]    8   14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]   19   26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]    9   27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]    2   14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]   16   22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,]    6   14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]   12   26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]   18   26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,]   13   22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,]   26   28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,]    7   29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dispersions_considered</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.7562317 0.8188051 0.8932547 0.9000676 0.9625287 0.9848395 0.9972598</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8] 1.0666849 1.0879575 1.1949480 1.1966636 1.2927882 1.2994952 1.3275895</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15] 1.3311682 1.3464776 1.3575125 1.3695842 1.4470740 1.4486377</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare to bicriterion heuristic:</span></span></span>
<span class="r-in"><span><span class="va">groups_heuristic</span> <span class="op">&lt;-</span> <span class="fu"><a href="anticlustering.html">anticlustering</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">distances</span>, </span></span>
<span class="r-in"><span>  K <span class="op">=</span> <span class="va">K</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="st">"brusco"</span>, </span></span>
<span class="r-in"><span>  objective <span class="op">=</span> <span class="st">"dispersion"</span>, </span></span>
<span class="r-in"><span>  repetitions <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  OPT <span class="op">=</span> <span class="fu"><a href="dispersion_objective.html">dispersion_objective</a></span><span class="op">(</span><span class="va">distances</span>, <span class="va">opt</span><span class="op">$</span><span class="va">groups</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  HEURISTIC <span class="op">=</span> <span class="fu"><a href="dispersion_objective.html">dispersion_objective</a></span><span class="op">(</span><span class="va">distances</span>, <span class="va">groups_heuristic</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       OPT HEURISTIC </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.448638  1.448638 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Different group sizes are possible:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu">optimal_dispersion</span><span class="op">(</span><span class="va">distances</span>, K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">10</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">groups</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1  2  3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 10  5 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Induce cannot-link constraints by maximizing the dispersion:</span></span></span>
<span class="r-in"><span><span class="va">solvable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>, ncol <span class="op">=</span> <span class="fl">6</span>, nrow <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">solvable</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">solvable</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">solvable</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">solvable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="va">solvable</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">solvable</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1  2  3  4  5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 -1            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -1  1         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 -1  1  1      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  1  1  1  1   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  1  1  1  1  1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># An optimal solution has to put item 1 in a different group than </span></span></span>
<span class="r-in"><span><span class="co"># items 2, 3 and 4 -&gt; this is possible for K = 2</span></span></span>
<span class="r-in"><span><span class="fu">optimal_dispersion</span><span class="op">(</span><span class="va">solvable</span>, K <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">groups</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 1 1 1 2 2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># It no longer works when item 1 can also not be linked with item 5:</span></span></span>
<span class="r-in"><span><span class="co"># (check out output!)</span></span></span>
<span class="r-in"><span><span class="va">unsolvable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">solvable</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">unsolvable</span><span class="op">[</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">unsolvable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="va">unsolvable</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">unsolvable</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1  2  3  4  5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 -1            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -1  1         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 -1  1  1      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 -1  1  1  1   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  1  1  1  1  1</span>
<span class="r-in"><span><span class="fu">optimal_dispersion</span><span class="op">(</span><span class="va">unsolvable</span>, K <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dispersion</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $groups</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $edges</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dispersions_considered</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># But:</span></span></span>
<span class="r-in"><span><span class="fu">optimal_dispersion</span><span class="op">(</span><span class="va">unsolvable</span>, K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="co"># group sizes, not number of groups</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dispersion</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $groups</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 1 1 1 1 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $groups_fixated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  2  1  1  1  1 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $edges</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    1    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    1    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]    1    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dispersions_considered</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Martin Papenberg.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

