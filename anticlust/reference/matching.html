<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Matching — matching • anticlust</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Matching — matching" />
<meta property="og:description" content="Conduct K-partite or unrestricted (minimum distance) matching to
find pairs or groups of similar elements. By default, finding
matches is based on the Euclidean distance between data points, but
a custom dissimilarity measure can also be employed." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">anticlust</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/stimulus-selection.html">Using the R package anticlust for stimulus selection in experiments</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/m-Py/anticlust">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Matching</h1>
    <small class="dont-index">Source: <a href='https://github.com/m-Py/anticlust/blob/master/R/wrapper-matching.R'><code>R/wrapper-matching.R</code></a></small>
    <div class="hidden name"><code>matching.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Conduct K-partite or unrestricted (minimum distance) matching to
find pairs or groups of similar elements. By default, finding
matches is based on the Euclidean distance between data points, but
a custom dissimilarity measure can also be employed.</p>
    </div>

    <pre class="usage"><span class='fu'>matching</span>(
  <span class='no'>x</span>,
  <span class='kw'>p</span> <span class='kw'>=</span> <span class='fl'>2</span>,
  <span class='kw'>match_between</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>match_within</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>match_extreme_first</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>target_group</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>sort_output</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>The data input. Can be one of two structures: (1) A data
matrix where rows correspond to elements and columns correspond
to features (a single numeric feature can be passed as a
vector). (2) An N x N matrix dissimilarity matrix; can be an
object of class <code>dist</code> (e.g., returned by
<code><a href='https://rdrr.io/r/stats/dist.html'>dist</a></code> or <code><a href='https://rdrr.io/r/stats/dist.html'>as.dist</a></code>) or a <code>matrix</code>
where the entries of the upper and lower triangular matrix
represent the pairwise dissimilarities.</p></td>
    </tr>
    <tr>
      <th>p</th>
      <td><p>The size of the groups; the default is 2, in which case
the function returns pairs.</p></td>
    </tr>
    <tr>
      <th>match_between</th>
      <td><p>An optional vector, <code>data.frame</code> or
matrix representing one or several categorical constraints. If
passed, the argument <code>p</code> is ignored and matches are sought
between elements of different categories.</p></td>
    </tr>
    <tr>
      <th>match_within</th>
      <td><p>An optional vector, <code>data.frame</code> or matrix
representing one or several categorical constraints. If passed,
matches are sought between elements of the same category.</p></td>
    </tr>
    <tr>
      <th>match_extreme_first</th>
      <td><p>Logical: Determines if matches are first
sought for extreme elements first or for central
elements. Defaults to <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>target_group</th>
      <td><p>Currently, the options "none",
smallest" and "diverse" are supported. See Details.</p></td>
    </tr>
    <tr>
      <th>sort_output</th>
      <td><p>Boolean. If <code>TRUE</code> (default), the output clusters 
are sorted by similarity. See Details.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An integer vector encoding the matches. See Details for
    more information.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>If the data input <code>x</code> is a feature matrix, matching is based
on the Euclidean distance between data points. If the argument
<code>x</code> is a dissimilarity matrix, matching is based on the
user-specified dissimilarities. To find matches, the algorithm
proceeds by selecting a target element and then searching its
nearest neighbours. Critical to the behaviour or the algorithm is
the order in which target elements are selected. By default, the
most extreme elements are selected first, i.e., elements with the
highest distance to the centroid of the data set (see
<code><a href='balanced_clustering.html'>balanced_clustering</a></code> that relies on the same
algorithm). Set the argument <code>match_extreme_first</code> to
<code>FALSE</code>, to enforce that elements close to the centroid are
first selected as targets.</p>
<p>If the argument <code>match_between</code> is passed and the groups
specified via this argument are of different size, target elements
are selected from the smallest group by default (because in this
group, all elements can be matched). However, it is also possible
to specify how matches are selected through the option
<code>target_group</code>. When specifying <code>"none"</code>, matches are
always selected from extreme elements, irregardless of the group
sizes (or from central elements first if <code>match_extreme_first
= FALSE</code>). With option <code>"smallest"</code>, matches are selected from
the smallest group. With option <code>"diverse"</code>, matches are
selected from the most heterogenous group according to the sum of
pairwise distances within groups.</p>
<p>The output is an integer vector encoding which elements have been
matched. The grouping numbers are sorted by similarity. That is,
elements with the grouping number »1« have the highest intra-group
similarity, followed by 2 etc (groups having the same similarity
index are still assigned a different grouping number,
though). Similarity is measured as the sum of pairwise (Euclidean)
distances within groups (see <code><a href='distance_objective.html'>distance_objective</a></code>). To 
prevent sorting by similarity (this is some extra computational burden),
set <code>sort_output = FALSE</code>. Some unmatched elements may be <code>NA</code>. 
This happens if it is not
possible to evenly split the item pool evenly into groups of size
<code>p</code> or if the categories described by the argument
<code>match_between</code> are of different size.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>It is possible to specify grouping restrictions via
    <code>match_between</code> and <code>match_within</code> at the same time.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># Find triplets</span>
<span class='no'>N</span> <span class='kw'>&lt;-</span> <span class='fl'>120</span>
<span class='no'>lds</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>f1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>N</span>), <span class='kw'>f2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>N</span>))
<span class='no'>triplets</span> <span class='kw'>&lt;-</span> <span class='fu'>matching</span>(<span class='no'>lds</span>, <span class='kw'>p</span> <span class='kw'>=</span> <span class='fl'>3</span>)
<span class='fu'><a href='plot_clusters.html'>plot_clusters</a></span>(
  <span class='no'>lds</span>,
  <span class='kw'>clusters</span> <span class='kw'>=</span> <span class='no'>triplets</span>,
  <span class='kw'>within_connection</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)</div><div class='img'><img src='matching-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Bipartite matching with unequal-sized groups:</span>
<span class='co'># Only selects matches for some elements</span>
<span class='no'>N</span> <span class='kw'>&lt;-</span> <span class='fl'>100</span>
<span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>N</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>1</span>)
<span class='no'>groups</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='fl'>1</span>:<span class='fl'>2</span>, <span class='kw'>size</span> <span class='kw'>=</span> <span class='no'>N</span>, <span class='kw'>replace</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.8</span>, <span class='fl'>0.2</span>))
<span class='no'>matched</span> <span class='kw'>&lt;-</span> <span class='fu'>matching</span>(<span class='no'>data</span>[, <span class='fl'>1</span>], <span class='kw'>match_between</span> <span class='kw'>=</span> <span class='no'>groups</span>)
<span class='fu'><a href='plot_clusters.html'>plot_clusters</a></span>(
  <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='no'>groups</span>, <span class='no'>data</span>),
  <span class='kw'>clusters</span> <span class='kw'>=</span> <span class='no'>matched</span>,
  <span class='kw'>within_connection</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)</div><div class='img'><img src='matching-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Match objects from the same category only</span>
<span class='no'>matched</span> <span class='kw'>&lt;-</span> <span class='fu'>matching</span>(
  <span class='no'>schaper2019</span>[, <span class='fl'>3</span>:<span class='fl'>6</span>],
  <span class='kw'>p</span> <span class='kw'>=</span> <span class='fl'>3</span>,
  <span class='kw'>match_within</span> <span class='kw'>=</span> <span class='no'>schaper2019</span>$<span class='no'>room</span>
)
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span>(<span class='no'>matched</span>, <span class='no'>schaper2019</span>$<span class='no'>room</span>))</div><div class='output co'>#&gt;        
#&gt; matched bathroom kitchen
#&gt;       1        0       3
#&gt;       2        3       0
#&gt;       3        0       3
#&gt;       4        0       3
#&gt;       5        3       0
#&gt;       6        3       0</div><div class='input'>
<span class='co'># Match between different plant species in the »iris« data set</span>
<span class='no'>species</span> <span class='kw'>&lt;-</span> <span class='no'>iris</span>$<span class='no'>Species</span> <span class='kw'>!=</span> <span class='st'>"versicolor"</span>
<span class='no'>matched</span> <span class='kw'>&lt;-</span> <span class='fu'>matching</span>(
  <span class='no'>iris</span>[<span class='no'>species</span>, <span class='fl'>1</span>],
  <span class='kw'>match_between</span> <span class='kw'>=</span> <span class='no'>iris</span>[<span class='no'>species</span>, <span class='fl'>5</span>]
)
<span class='co'># Adjust `match_extreme_first` argument</span>
<span class='no'>matched2</span> <span class='kw'>&lt;-</span> <span class='fu'>matching</span>(
  <span class='no'>iris</span>[<span class='no'>species</span>, <span class='fl'>1</span>],
  <span class='kw'>match_between</span> <span class='kw'>=</span> <span class='no'>iris</span>[<span class='no'>species</span>, <span class='fl'>5</span>],
  <span class='kw'>match_extreme_first</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)
<span class='co'># Plot the matching results</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mfrow</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>2</span>))
<span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(
  <span class='kw'>Species</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span>(<span class='no'>iris</span>[<span class='no'>species</span>, <span class='fl'>5</span>]),
  <span class='kw'>Sepal.Length</span> <span class='kw'>=</span> <span class='no'>iris</span>[<span class='no'>species</span>, <span class='fl'>1</span>]
)
<span class='fu'><a href='plot_clusters.html'>plot_clusters</a></span>(
  <span class='no'>data</span>,
  <span class='kw'>clusters</span> <span class='kw'>=</span> <span class='no'>matched</span>,
  <span class='kw'>within_connection</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Extreme elements matched first"</span>
)
<span class='fu'><a href='plot_clusters.html'>plot_clusters</a></span>(
  <span class='no'>data</span>,
  <span class='kw'>clusters</span> <span class='kw'>=</span> <span class='no'>matched2</span>,
  <span class='kw'>within_connection</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Central elements matched first"</span>
)</div><div class='img'><img src='matching-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mfrow</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>1</span>))</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#note">Note</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Martin Papenberg <a href='mailto:martin.papenberg@hhu.de'>martin.papenberg@hhu.de</a></p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Martin Papenberg.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


