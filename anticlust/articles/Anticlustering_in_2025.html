<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Anticlustering in 2025 • anticlust</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Anticlustering in 2025">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">anticlust</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.8.12</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Anticlustering_in_2025.html">Anticlustering in 2025</a>
    </li>
    <li>
      <a href="../articles/Best_practices.html">Some best practices for anticlustering</a>
    </li>
    <li>
      <a href="../articles/Categorical_vars.html">Using categorical variables with anticlustering</a>
    </li>
    <li>
      <a href="../articles/Speeding_up_anticlustering.html">Speeding up anticlustering</a>
    </li>
    <li>
      <a href="../articles/stimulus-selection.html">Using the R package anticlust for stimulus selection in experiments</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="https://m-py.github.io/anticlust-blog" class="external-link">Blog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/m-Py/anticlust/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Anticlustering in 2025</h1>
                        <h4 data-toc-skip class="author">Martin
Papenberg</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/m-Py/anticlust/blob/HEAD/vignettes/Anticlustering_in_2025.Rmd" class="external-link"><code>vignettes/Anticlustering_in_2025.Rmd</code></a></small>
      <div class="hidden name"><code>Anticlustering_in_2025.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/m-Py/anticlust" class="external-link">anticlust</a></span><span class="op">)</span></span></code></pre></div>
<p>This vignette is (in October 2025) the most up-to-date reference for
doing anticlustering. Here, I summarize some of the things I learned
about—or implemented for—anticlustering, which may not be documented in
earlier work (e.g., papers, other vignettes). For example, if you have
used <code>anticlust</code> before, you may be interested to know about
recent changes, available from version 0.8.12 onward:</p>
<ul>
<li>Categorical variables can now be directly included as the data input
when defined as <code>factor</code>s (which is R’s data structure for
categorical variables)</li>
<li>Missing values are now handled directly by
<code><a href="../reference/anticlustering.html">anticlustering()</a></code>
</li>
</ul>
<p>I will use these changes in the running example below. Of course, in
both cases (categorical variables and <code>NA</code>s), a more
specialized handling could be preferred in certain settings; defaults
can never be optimal for all applications.</p>
<p>Moreover, we have implemented the three phase search algorithm by <a href="https://doi.org/10.1016/j.ejor.2022.02.003" class="external-link">Yang et al.</a>, which
seems to be the most powerful algorithm for anticlustering that we have
included so far. I will showcase it below.</p>
<p>To reproduce the running example, install the “MASS” package that
contains the <code>survey</code> data set that is used.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">survey</span><span class="op">)</span>       <span class="co"># load data set</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">survey</span><span class="op">)</span>       <span class="co"># number of students</span></span>
<span><span class="co">#&gt; [1] 237</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">survey</span>, n<span class="op">=</span><span class="fl">10</span><span class="op">)</span> <span class="co"># look at the data</span></span>
<span><span class="co">#&gt;       Sex Wr.Hnd NW.Hnd W.Hnd    Fold Pulse    Clap Exer Smoke Height      M.I</span></span>
<span><span class="co">#&gt; 1  Female   18.5   18.0 Right  R on L    92    Left Some Never 173.00   Metric</span></span>
<span><span class="co">#&gt; 2    Male   19.5   20.5  Left  R on L   104    Left None Regul 177.80 Imperial</span></span>
<span><span class="co">#&gt; 3    Male   18.0   13.3 Right  L on R    87 Neither None Occas     NA     &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4    Male   18.8   18.9 Right  R on L    NA Neither None Never 160.00   Metric</span></span>
<span><span class="co">#&gt; 5    Male   20.0   20.0 Right Neither    35   Right Some Never 165.00   Metric</span></span>
<span><span class="co">#&gt; 6  Female   18.0   17.7 Right  L on R    64   Right Some Never 172.72 Imperial</span></span>
<span><span class="co">#&gt; 7    Male   17.7   17.7 Right  L on R    83   Right Freq Never 182.88 Imperial</span></span>
<span><span class="co">#&gt; 8  Female   17.0   17.3 Right  R on L    74   Right Freq Never 157.00   Metric</span></span>
<span><span class="co">#&gt; 9    Male   20.0   19.5 Right  R on L    72   Right Some Never 175.00   Metric</span></span>
<span><span class="co">#&gt; 10   Male   18.5   18.5 Right  R on L    90   Right Some Never 167.00   Metric</span></span>
<span><span class="co">#&gt;       Age</span></span>
<span><span class="co">#&gt; 1  18.250</span></span>
<span><span class="co">#&gt; 2  17.583</span></span>
<span><span class="co">#&gt; 3  16.917</span></span>
<span><span class="co">#&gt; 4  20.333</span></span>
<span><span class="co">#&gt; 5  23.667</span></span>
<span><span class="co">#&gt; 6  21.000</span></span>
<span><span class="co">#&gt; 7  18.833</span></span>
<span><span class="co">#&gt; 8  35.833</span></span>
<span><span class="co">#&gt; 9  19.000</span></span>
<span><span class="co">#&gt; 10 22.333</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">survey</span>, <span class="va">anyNA</span><span class="op">)</span> <span class="co"># most variables contain missing values</span></span>
<span><span class="co">#&gt;    Sex Wr.Hnd NW.Hnd  W.Hnd   Fold  Pulse   Clap   Exer  Smoke Height    M.I </span></span>
<span><span class="co">#&gt;   TRUE   TRUE   TRUE   TRUE  FALSE   TRUE   TRUE  FALSE   TRUE   TRUE   TRUE </span></span>
<span><span class="co">#&gt;    Age </span></span>
<span><span class="co">#&gt;  FALSE</span></span></code></pre></div>
<p>The <code>survey</code> data set contains some demographic
information on a student sample. Imagine you wish to assign students to
three different dormitories and want to create a similar groups of
students in each house. In this example I will use the following
features (brackets contain the description contained in the R
documentation, <code><a href="https://rdrr.io/pkg/MASS/man/survey.html" class="external-link">?MASS::survey</a></code>):</p>
<p><strong>Categorical features:</strong></p>
<ul>
<li>
<code>Sex</code>: The sex of the student (Factor with levels “Male”
and “Female”.)</li>
<li>
<code>W.Hnd</code>: writing hand of student. (Factor, with levels
“Left” and “Right”.)</li>
<li>
<code>Exer</code>: how often the student exercises. (Factor, with
levels “Freq” (frequently), “Some”, “None”.)</li>
<li>
<code>Smoke</code>: how much the student smokes. (Factor, levels
“Heavy”, “Regul” (regularly), “Occas” (occasionally), “Never”.)</li>
</ul>
<p>All of the categorical features are already defined as factor
variables, which I will make use of.</p>
<p><strong>Numeric features:</strong></p>
<ul>
<li>
<code>Pulse</code>: pulse rate of student (beats per minute).</li>
<li>
<code>Height</code>: height of the student in centimetres.</li>
<li>
<code>Age</code>: age of the student in years.</li>
</ul>
<p>I will select these features as a new data frame and apply the
default anticlustering method to create 3 equal-sized groups.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">features</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sex"</span>, <span class="st">"W.Hnd"</span>, <span class="st">"Exer"</span>, <span class="st">"Smoke"</span>, <span class="st">"Pulse"</span>, <span class="st">"Height"</span>, <span class="st">"Age"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">survey</span><span class="op">$</span><span class="va">House</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anticlustering.html">anticlustering</a></span><span class="op">(</span></span>
<span>  <span class="va">survey</span><span class="op">[</span>, <span class="va">features</span><span class="op">]</span>, </span>
<span>  K <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>I use the <code>tableone</code> package to illustrate the descriptive
statistics by group. For numeric variables, we get means and standard
deviations; for categorical variables, we get counts and percentages. It
even gives a <em>p</em>-value as a (sort of) measure of imbalance among
houses for each variable. For categorical variables, the
<em>p</em>-value is the result of a chi squared test. Higher values
indicate that the observed distribution of categories among houses is
more uniform. For numeric variables, the <code>oneway.test</code> is
used, which compares 2 or several means (for 2 means, it is equivalent
to the <em>t</em>-test). Higher <em>p</em>-values indicate less
discrepancy between group means (however, other characteristics such as
the standard deviation are not considered).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/kaz-yos/tableone" class="external-link">tableone</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tableone/man/CreateTableOne.html" class="external-link">CreateTableOne</a></span><span class="op">(</span><span class="va">features</span>, strata <span class="op">=</span> <span class="st">"House"</span>, data <span class="op">=</span> <span class="va">survey</span><span class="op">)</span></span>
<span><span class="co">#&gt;                     Stratified by House</span></span>
<span><span class="co">#&gt;                      1              2              3              p      test</span></span>
<span><span class="co">#&gt;   n                      79             79             79                    </span></span>
<span><span class="co">#&gt;   Sex = Male (%)         40 (50.6)      41 (52.6)      37 (46.8)   0.766     </span></span>
<span><span class="co">#&gt;   W.Hnd = Right (%)      73 (92.4)      72 (91.1)      73 (93.6)   0.846     </span></span>
<span><span class="co">#&gt;   Exer (%)                                                         0.803     </span></span>
<span><span class="co">#&gt;      Freq                37 (46.8)      40 (50.6)      38 (48.1)             </span></span>
<span><span class="co">#&gt;      None                 6 ( 7.6)       8 (10.1)      10 (12.7)             </span></span>
<span><span class="co">#&gt;      Some                36 (45.6)      31 (39.2)      31 (39.2)             </span></span>
<span><span class="co">#&gt;   Smoke (%)                                                        0.363     </span></span>
<span><span class="co">#&gt;      Heavy                4 ( 5.1)       2 ( 2.6)       5 ( 6.3)             </span></span>
<span><span class="co">#&gt;      Never               61 (77.2)      62 (79.5)      66 (83.5)             </span></span>
<span><span class="co">#&gt;      Occas                5 ( 6.3)       8 (10.3)       6 ( 7.6)             </span></span>
<span><span class="co">#&gt;      Regul                9 (11.4)       6 ( 7.7)       2 ( 2.5)             </span></span>
<span><span class="co">#&gt;   Pulse (mean (SD))   74.38 (11.62)  73.92 (13.93)  74.15 (3.53)   0.971     </span></span>
<span><span class="co">#&gt;   Height (mean (SD)) 172.76 (11.08) 172.16 (5.29)  172.14 (11.25)  0.910     </span></span>
<span><span class="co">#&gt;   Age (mean (SD))     19.49 (2.99)   20.22 (6.80)   21.41 (8.35)   0.170</span></span></code></pre></div>
<p>By default, the <code><a href="../reference/anticlustering.html">anticlustering()</a></code> method maximizes the
<code>diversity</code> objective, which strives for a similar overall
data distribution among groups. It is difficult to assess the
adequateness of the solution without a comparison. So let us first add
an random assignment as baseline comparison:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">survey</span><span class="op">$</span><span class="va">Rnd_House</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">survey</span><span class="op">$</span><span class="va">House</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tableone/man/CreateTableOne.html" class="external-link">CreateTableOne</a></span><span class="op">(</span><span class="va">features</span>, strata <span class="op">=</span> <span class="st">"Rnd_House"</span>, data <span class="op">=</span> <span class="va">survey</span><span class="op">)</span></span>
<span><span class="co">#&gt;                     Stratified by Rnd_House</span></span>
<span><span class="co">#&gt;                      1              2              3              p      test</span></span>
<span><span class="co">#&gt;   n                      79             79             79                    </span></span>
<span><span class="co">#&gt;   Sex = Male (%)         34 (43.6)      48 (60.8)      36 (45.6)   0.062     </span></span>
<span><span class="co">#&gt;   W.Hnd = Right (%)      74 (93.7)      69 (88.5)      75 (94.9)   0.270     </span></span>
<span><span class="co">#&gt;   Exer (%)                                                         0.401     </span></span>
<span><span class="co">#&gt;      Freq                34 (43.0)      43 (54.4)      38 (48.1)             </span></span>
<span><span class="co">#&gt;      None                 6 ( 7.6)       8 (10.1)      10 (12.7)             </span></span>
<span><span class="co">#&gt;      Some                39 (49.4)      28 (35.4)      31 (39.2)             </span></span>
<span><span class="co">#&gt;   Smoke (%)                                                        0.252     </span></span>
<span><span class="co">#&gt;      Heavy                3 ( 3.8)       5 ( 6.4)       3 ( 3.8)             </span></span>
<span><span class="co">#&gt;      Never               62 (78.5)      57 (73.1)      70 (88.6)             </span></span>
<span><span class="co">#&gt;      Occas                8 (10.1)       7 ( 9.0)       4 ( 5.1)             </span></span>
<span><span class="co">#&gt;      Regul                6 ( 7.6)       9 (11.5)       2 ( 2.5)             </span></span>
<span><span class="co">#&gt;   Pulse (mean (SD))   73.88 (10.79)  72.83 (12.97)  75.86 (10.98)  0.325     </span></span>
<span><span class="co">#&gt;   Height (mean (SD)) 169.76 (9.76)  175.67 (9.65)  172.02 (9.40)   0.002     </span></span>
<span><span class="co">#&gt;   Age (mean (SD))     20.98 (8.75)   20.05 (4.83)   20.09 (5.13)   0.597</span></span></code></pre></div>
<p>The <em>p</em>-values tend to be lower, and the <em>p</em>-value for
height would even be considered “significant” in an inference testing
setting (however, note that such an interpretation is not appropriate in
this setting). So, apparently, anticlustering helped to form a more even
observed distribution of the input variables among houses.</p>
<div class="section level2">
<h2 id="improving-the-results">Improving the results<a class="anchor" aria-label="anchor" href="#improving-the-results"></a>
</h2>
<p>I think that the result from the “default” anticlustering method are
okay’ish. However, let’s assume we want to ensure an even more optimized
assignment where the variables are more even among houses. Here I list
three options:</p>
<ul>
<li>Use standardization (<strong>always recommended</strong>)</li>
<li>Use better algorithm (<strong>usually recommended</strong>)</li>
<li>Change the objective function (<strong>recommended depending on
requirements of application</strong>)</li>
</ul>
<div class="section level3">
<h3 id="standardization">Standardization<a class="anchor" aria-label="anchor" href="#standardization"></a>
</h3>
<p>A first step to improve results is using standardization. It always
should be used (especially when using categorical and numeric
variables), but as discussed elsewhere, it is not the default. Let’s
repeat our previous code but now use standardization with the
<code>standardize</code> argument.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">survey</span><span class="op">$</span><span class="va">House2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anticlustering.html">anticlustering</a></span><span class="op">(</span></span>
<span>  <span class="va">survey</span><span class="op">[</span>, <span class="va">features</span><span class="op">]</span>, </span>
<span>  K <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  standardize <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tableone/man/CreateTableOne.html" class="external-link">CreateTableOne</a></span><span class="op">(</span><span class="va">features</span>, strata <span class="op">=</span> <span class="st">"House2"</span>, data <span class="op">=</span> <span class="va">survey</span><span class="op">)</span></span>
<span><span class="co">#&gt;                     Stratified by House2</span></span>
<span><span class="co">#&gt;                      1              2              3              p      test</span></span>
<span><span class="co">#&gt;   n                      79             79             79                    </span></span>
<span><span class="co">#&gt;   Sex = Male (%)         39 (49.4)      39 (50.0)      40 (50.6)   0.987     </span></span>
<span><span class="co">#&gt;   W.Hnd = Right (%)      74 (93.7)      72 (91.1)      72 (92.3)   0.835     </span></span>
<span><span class="co">#&gt;   Exer (%)                                                         0.991     </span></span>
<span><span class="co">#&gt;      Freq                39 (49.4)      38 (48.1)      38 (48.1)             </span></span>
<span><span class="co">#&gt;      None                 7 ( 8.9)       8 (10.1)       9 (11.4)             </span></span>
<span><span class="co">#&gt;      Some                33 (41.8)      33 (41.8)      32 (40.5)             </span></span>
<span><span class="co">#&gt;   Smoke (%)                                                        0.999     </span></span>
<span><span class="co">#&gt;      Heavy                4 ( 5.1)       4 ( 5.1)       3 ( 3.8)             </span></span>
<span><span class="co">#&gt;      Never               63 (79.7)      63 (79.7)      63 (80.8)             </span></span>
<span><span class="co">#&gt;      Occas                6 ( 7.6)       6 ( 7.6)       7 ( 9.0)             </span></span>
<span><span class="co">#&gt;      Regul                6 ( 7.6)       6 ( 7.6)       5 ( 6.4)             </span></span>
<span><span class="co">#&gt;   Pulse (mean (SD))   74.53 (14.50)  73.75 (11.33)  74.09 (4.65)   0.922     </span></span>
<span><span class="co">#&gt;   Height (mean (SD)) 172.60 (11.29) 172.24 (5.02)  172.25 (10.89)  0.969     </span></span>
<span><span class="co">#&gt;   Age (mean (SD))     19.98 (4.04)   20.54 (7.73)   20.60 (7.11)   0.802</span></span></code></pre></div>
<p>Standardization has a remarkable effect, in particular on the
categorical variables. So you definitely should use it: It ensures that
all variables are equally important when conducting anticlustering.</p>
</div>
<div class="section level3">
<h3 id="using-a-better-algorithm">Using a better algorithm<a class="anchor" aria-label="anchor" href="#using-a-better-algorithm"></a>
</h3>
<p>The <code>method</code> argument determines the algorithm, which
conducts the anticlustering optimization. The default is
<code>exchange</code>, which is a compromise between speed and solution
quality. In many applications, it is possible to use a better algorithm
because speed is not an issue. Using method = <code>local-maximum</code>
basically maintains the same algorithm, but runs longer until a
so-called local maximum is reached. It would be a good next step.
However, here I directly use the tree phase search algorithm, which is
new in <code>anticlust</code> and outperforms the
<code>local-maximum</code> method. Sometimes, it can even be faster.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">survey</span><span class="op">$</span><span class="va">House3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anticlustering.html">anticlustering</a></span><span class="op">(</span></span>
<span>  <span class="va">survey</span><span class="op">[</span>, <span class="va">features</span><span class="op">]</span>, </span>
<span>  K <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  standardize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"3phase"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tableone/man/CreateTableOne.html" class="external-link">CreateTableOne</a></span><span class="op">(</span><span class="va">features</span>, strata <span class="op">=</span> <span class="st">"House3"</span>, data <span class="op">=</span> <span class="va">survey</span><span class="op">)</span></span>
<span><span class="co">#&gt;                     Stratified by House3</span></span>
<span><span class="co">#&gt;                      1              2              3              p      test</span></span>
<span><span class="co">#&gt;   n                      79             79             79                    </span></span>
<span><span class="co">#&gt;   Sex = Male (%)         38 (48.7)      40 (50.6)      40 (50.6)   0.962     </span></span>
<span><span class="co">#&gt;   W.Hnd = Right (%)      72 (92.3)      73 (92.4)      73 (92.4)   1.000     </span></span>
<span><span class="co">#&gt;   Exer (%)                                                         1.000     </span></span>
<span><span class="co">#&gt;      Freq                39 (49.4)      38 (48.1)      38 (48.1)             </span></span>
<span><span class="co">#&gt;      None                 8 (10.1)       8 (10.1)       8 (10.1)             </span></span>
<span><span class="co">#&gt;      Some                32 (40.5)      33 (41.8)      33 (41.8)             </span></span>
<span><span class="co">#&gt;   Smoke (%)                                                        0.999     </span></span>
<span><span class="co">#&gt;      Heavy                4 ( 5.1)       4 ( 5.1)       3 ( 3.8)             </span></span>
<span><span class="co">#&gt;      Never               63 (79.7)      62 (79.5)      64 (81.0)             </span></span>
<span><span class="co">#&gt;      Occas                7 ( 8.9)       6 ( 7.7)       6 ( 7.6)             </span></span>
<span><span class="co">#&gt;      Regul                5 ( 6.3)       6 ( 7.7)       6 ( 7.6)             </span></span>
<span><span class="co">#&gt;   Pulse (mean (SD))   73.60 (10.40)  74.38 (4.92)   74.49 (15.08)  0.890     </span></span>
<span><span class="co">#&gt;   Height (mean (SD)) 172.43 (5.16)  172.31 (11.41) 172.41 (10.72)  0.997     </span></span>
<span><span class="co">#&gt;   Age (mean (SD))     20.53 (7.57)   20.46 (7.05)   20.13 (4.44)   0.917</span></span></code></pre></div>
<p>It seems that using the improved algorithm also translated into a
more even distribution of variables among groups.</p>
</div>
<div class="section level3">
<h3 id="changing-the-objective-function">Changing the objective function<a class="anchor" aria-label="anchor" href="#changing-the-objective-function"></a>
</h3>
<p>In some settings we may be interests in optimizing similarity with
regard to certain distribution characteristics among groups. One
possibility is to focus on the average of each variable. Though I
strongly discourage focusing on mean values alone (e.g., see Papenberg,
2024), let’s discuss here how it could be done. To just focus on mean
values, we can replace the default diversity objective by the
<em>k</em>-means criterion (also called the <em>variance</em>). The
objective function is set via the <code>objective</code> argument. It
defines how the similarity between groups is computed and it is the so
called optimization criterion; the anticlustering algorithm proceeds in
such a way that the grouping maximizes the objective function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">survey</span><span class="op">$</span><span class="va">House4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anticlustering.html">anticlustering</a></span><span class="op">(</span></span>
<span>  <span class="va">survey</span><span class="op">[</span>, <span class="va">features</span><span class="op">]</span>, </span>
<span>  K <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  standardize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"3phase"</span>,</span>
<span>  objective <span class="op">=</span> <span class="st">"variance"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tableone/man/CreateTableOne.html" class="external-link">CreateTableOne</a></span><span class="op">(</span><span class="va">features</span>, strata <span class="op">=</span> <span class="st">"House4"</span>, data <span class="op">=</span> <span class="va">survey</span><span class="op">)</span></span>
<span><span class="co">#&gt;                     Stratified by House4</span></span>
<span><span class="co">#&gt;                      1              2              3              p      test</span></span>
<span><span class="co">#&gt;   n                      79             79             79                    </span></span>
<span><span class="co">#&gt;   Sex = Male (%)         39 (50.0)      39 (49.4)      40 (50.6)   0.987     </span></span>
<span><span class="co">#&gt;   W.Hnd = Right (%)      72 (92.3)      73 (92.4)      73 (92.4)   1.000     </span></span>
<span><span class="co">#&gt;   Exer (%)                                                         0.991     </span></span>
<span><span class="co">#&gt;      Freq                38 (48.1)      39 (49.4)      38 (48.1)             </span></span>
<span><span class="co">#&gt;      None                 9 (11.4)       7 ( 8.9)       8 (10.1)             </span></span>
<span><span class="co">#&gt;      Some                32 (40.5)      33 (41.8)      33 (41.8)             </span></span>
<span><span class="co">#&gt;   Smoke (%)                                                        0.998     </span></span>
<span><span class="co">#&gt;      Heavy                4 ( 5.1)       3 ( 3.8)       4 ( 5.1)             </span></span>
<span><span class="co">#&gt;      Never               61 (78.2)      64 (81.0)      64 (81.0)             </span></span>
<span><span class="co">#&gt;      Occas                7 ( 9.0)       6 ( 7.6)       6 ( 7.6)             </span></span>
<span><span class="co">#&gt;      Regul                6 ( 7.7)       6 ( 7.6)       5 ( 6.3)             </span></span>
<span><span class="co">#&gt;   Pulse (mean (SD))   74.13 (4.66)   74.19 (8.66)   74.13 (15.90)  0.999     </span></span>
<span><span class="co">#&gt;   Height (mean (SD)) 172.58 (7.79)  172.32 (13.66) 172.27 (5.31)   0.982     </span></span>
<span><span class="co">#&gt;   Age (mean (SD))     20.78 (9.06)   20.11 (4.19)   20.23 (5.20)   0.786</span></span></code></pre></div>
<p>Overall, using the variance objective does not really seem to improve
results. Maybe, the mean values for <code>Pulse</code> are more evenly
distributed. Additionally, we can see that the standard deviations for
some of the numeric variables (in particular, <code>Pulse</code>) are
highly dissimilar. Thus, the distribution of this variable is not
similar between groups even though the means are similar: Group 1 has
little spread around the mean and thus consists of “average” students
regarding pulse; group 3 has a large spread around the mean and
therefore tends to consist of students with either very high or very low
pulse. This even can be illustrated visually, when using house
affiliation to color the Pulse values:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#a9a9a9"</span>, <span class="st">"#df536b"</span>, <span class="st">"#61d04f"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">survey</span><span class="op">$</span><span class="va">Pulse</span><span class="op">)</span></span>
<span><span class="co"># Plot the data while visualizing the different clusters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">survey</span><span class="op">$</span><span class="va">Pulse</span><span class="op">[</span><span class="va">ord</span><span class="op">]</span>, </span>
<span>  col <span class="op">=</span> <span class="va">colors</span><span class="op">[</span><span class="va">survey</span><span class="op">$</span><span class="va">House4</span><span class="op">[</span><span class="va">ord</span><span class="op">]</span><span class="op">]</span>, </span>
<span>  pch <span class="op">=</span> <span class="fl">19</span>, </span>
<span>  ylab <span class="op">=</span> <span class="st">"Pulse"</span>, </span>
<span>  xlab <span class="op">=</span> <span class="st">"Students (ordered by pulse)"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Group"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, col <span class="op">=</span> <span class="va">colors</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span></code></pre></div>
<p><img src="Anticlustering_in_2025_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>This plot is an astonishing illustration why the <em>k</em>-means
objective can be problematic (and why you should not only rely on
<em>p</em> values to assess whether the distribution of numeric
variables differs between groups). Admittedly, this problem also
occurred with the previous solution that used the default diversity
objective. However, it is more likely to occur with the <em>k</em>-means
approach.</p>
<p>Let’s use the <em>k</em>-plus objective that tries to correct for the
mean/SD problem by trying to match both means and standard deviations of
the input variables:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">survey</span><span class="op">$</span><span class="va">House5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anticlustering.html">anticlustering</a></span><span class="op">(</span></span>
<span>  <span class="va">survey</span><span class="op">[</span>, <span class="va">features</span><span class="op">]</span>, </span>
<span>  K <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"3phase"</span>,</span>
<span>  objective <span class="op">=</span> <span class="st">"kplus"</span>,</span>
<span>  standardize <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tableone/man/CreateTableOne.html" class="external-link">CreateTableOne</a></span><span class="op">(</span><span class="va">features</span>, strata <span class="op">=</span> <span class="st">"House5"</span>, data <span class="op">=</span> <span class="va">survey</span><span class="op">)</span></span>
<span><span class="co">#&gt;                     Stratified by House5</span></span>
<span><span class="co">#&gt;                      1              2              3              p      test</span></span>
<span><span class="co">#&gt;   n                      79             79             79                    </span></span>
<span><span class="co">#&gt;   Sex = Male (%)         39 (49.4)      40 (50.6)      39 (50.0)   0.987     </span></span>
<span><span class="co">#&gt;   W.Hnd = Right (%)      74 (93.7)      74 (93.7)      70 (89.7)   0.565     </span></span>
<span><span class="co">#&gt;   Exer (%)                                                         0.991     </span></span>
<span><span class="co">#&gt;      Freq                39 (49.4)      38 (48.1)      38 (48.1)             </span></span>
<span><span class="co">#&gt;      None                 7 ( 8.9)       8 (10.1)       9 (11.4)             </span></span>
<span><span class="co">#&gt;      Some                33 (41.8)      33 (41.8)      32 (40.5)             </span></span>
<span><span class="co">#&gt;   Smoke (%)                                                        0.946     </span></span>
<span><span class="co">#&gt;      Heavy                3 ( 3.8)       3 ( 3.8)       5 ( 6.4)             </span></span>
<span><span class="co">#&gt;      Never               65 (82.3)      65 (82.3)      59 (75.6)             </span></span>
<span><span class="co">#&gt;      Occas                6 ( 7.6)       6 ( 7.6)       7 ( 9.0)             </span></span>
<span><span class="co">#&gt;      Regul                5 ( 6.3)       5 ( 6.3)       7 ( 9.0)             </span></span>
<span><span class="co">#&gt;   Pulse (mean (SD))   74.13 (12.12)  74.16 (12.64)  74.16 (8.50)   1.000     </span></span>
<span><span class="co">#&gt;   Height (mean (SD)) 172.43 (10.42) 172.35 (10.04) 172.34 (8.86)   0.998     </span></span>
<span><span class="co">#&gt;   Age (mean (SD))     20.32 (4.64)   20.30 (5.12)   20.50 (8.89)   0.978</span></span></code></pre></div>
<p>This solution has the most even distribution for the pulse variable
of all our solutions. However, it is slightly worse with regard to
balance in the handedness variable. This shows that there is oftentimes
no unique best solution, and there are tradeoffs to consider. For
example, using more variables makes the problem harder on an algorithmic
level. We might ask if it is necessary to balance handedness between
houses? If not, we may leave out the variable? Or is some loss in
balance acceptable for some variables? In this application, I would
argue that the imbalance in handedness is not severe (right handedness
differs between 93.7% and 89.7% between houses). However, the imbalance
observed in the standard deviation of the pulse variable—that we
obtained when using the diversity and <em>k</em>-means objectives—could
be considered severe. So we might want to stick with the <em>k</em>-plus
solution. In an actual application this decision is up to the user, it
cannot be done automatically or optimally by an algorithm. You should
try out different approaches and use the one which is best for your
case.</p>
</div>
<div class="section level3">
<h3 id="unequal-group-sizes">Unequal group sizes<a class="anchor" aria-label="anchor" href="#unequal-group-sizes"></a>
</h3>
<p>Let’s assume we have three different sized houses. We can incorporate
this using the <code>K</code> argument by describing the size of each
group. Some things are to consider with this change in requirements.
First, let’s just repeat the anticlustering assignment using the default
diversity objective, but using different group sizes.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">survey</span><span class="op">$</span><span class="va">House6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anticlustering.html">anticlustering</a></span><span class="op">(</span></span>
<span>  <span class="va">survey</span><span class="op">[</span>, <span class="va">features</span><span class="op">]</span>, </span>
<span>  K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">137</span>, <span class="fl">50</span>, <span class="fl">50</span><span class="op">)</span>,</span>
<span>  standardize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"3phase"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tableone/man/CreateTableOne.html" class="external-link">CreateTableOne</a></span><span class="op">(</span><span class="va">features</span>, strata <span class="op">=</span> <span class="st">"House6"</span>, data <span class="op">=</span> <span class="va">survey</span><span class="op">)</span></span>
<span><span class="co">#&gt;                     Stratified by House6</span></span>
<span><span class="co">#&gt;                      1              2               3               p      test</span></span>
<span><span class="co">#&gt;   n                     137             50              50                     </span></span>
<span><span class="co">#&gt;   Sex = Male (%)         71 (52.2)      24 ( 48.0)      23 ( 46.0)   0.717     </span></span>
<span><span class="co">#&gt;   W.Hnd = Right (%)     118 (86.8)      50 (100.0)      50 (100.0)   0.001     </span></span>
<span><span class="co">#&gt;   Exer (%)                                                           0.003     </span></span>
<span><span class="co">#&gt;      Freq                63 (46.0)      26 ( 52.0)      26 ( 52.0)             </span></span>
<span><span class="co">#&gt;      None                23 (16.8)       0 (  0.0)       1 (  2.0)             </span></span>
<span><span class="co">#&gt;      Some                51 (37.2)      24 ( 48.0)      23 ( 46.0)             </span></span>
<span><span class="co">#&gt;   Smoke (%)                                                         &lt;0.001     </span></span>
<span><span class="co">#&gt;      Heavy               11 ( 8.1)       0 (  0.0)       0 (  0.0)             </span></span>
<span><span class="co">#&gt;      Never               89 (65.4)      50 (100.0)      50 (100.0)             </span></span>
<span><span class="co">#&gt;      Occas               19 (14.0)       0 (  0.0)       0 (  0.0)             </span></span>
<span><span class="co">#&gt;      Regul               17 (12.5)       0 (  0.0)       0 (  0.0)             </span></span>
<span><span class="co">#&gt;   Pulse (mean (SD))   74.44 (13.51)  73.60 (9.07)    73.82 (3.78)    0.904     </span></span>
<span><span class="co">#&gt;   Height (mean (SD)) 172.42 (11.33) 172.06 (5.85)   172.54 (8.18)    0.973     </span></span>
<span><span class="co">#&gt;   Age (mean (SD))     21.19 (8.21)   19.09 (1.92)    19.42 (2.58)    0.071</span></span></code></pre></div>
<p>Wow, this is really bad! We certainly would not want such an
assignment. For the categorical variables, we now have strongly
different distributions. For the numeric variables, mean values are
similar between groups, but the standard deviations are highly
different. Why did this happen? <strong>The diversity is actually not a
good measure of between-group similarity when group sizes are
unequal.</strong> We could use the “average diversity”, which takes into
consideration group sizes. Currently, the three phase algorithm only
supports the diversity objective for unequal-sized groups, so we must
choose a “classical” algorithm:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">survey</span><span class="op">$</span><span class="va">House7</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anticlustering.html">anticlustering</a></span><span class="op">(</span></span>
<span>  <span class="va">survey</span><span class="op">[</span>, <span class="va">features</span><span class="op">]</span>, </span>
<span>  K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">137</span>, <span class="fl">50</span>, <span class="fl">50</span><span class="op">)</span>,</span>
<span>  standardize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"local-maximum"</span>,</span>
<span>  repetitions <span class="op">=</span> <span class="fl">10</span>, <span class="co"># increasing repetitions may be helpful with method = "local-maximum"</span></span>
<span>  objective <span class="op">=</span> <span class="st">"average-diversity"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tableone/man/CreateTableOne.html" class="external-link">CreateTableOne</a></span><span class="op">(</span><span class="va">features</span>, strata <span class="op">=</span> <span class="st">"House7"</span>, data <span class="op">=</span> <span class="va">survey</span><span class="op">)</span></span>
<span><span class="co">#&gt;                     Stratified by House7</span></span>
<span><span class="co">#&gt;                      1              2              3              p      test</span></span>
<span><span class="co">#&gt;   n                     137             50             50                    </span></span>
<span><span class="co">#&gt;   Sex = Male (%)         69 (50.4)      24 (49.0)      25 (50.0)   0.986     </span></span>
<span><span class="co">#&gt;   W.Hnd = Right (%)     127 (92.7)      45 (91.8)      46 (92.0)   0.975     </span></span>
<span><span class="co">#&gt;   Exer (%)                                                         1.000     </span></span>
<span><span class="co">#&gt;      Freq                66 (48.2)      25 (50.0)      24 (48.0)             </span></span>
<span><span class="co">#&gt;      None                14 (10.2)       5 (10.0)       5 (10.0)             </span></span>
<span><span class="co">#&gt;      Some                57 (41.6)      20 (40.0)      21 (42.0)             </span></span>
<span><span class="co">#&gt;   Smoke (%)                                                        0.999     </span></span>
<span><span class="co">#&gt;      Heavy                7 ( 5.1)       2 ( 4.0)       2 ( 4.0)             </span></span>
<span><span class="co">#&gt;      Never              109 (80.1)      40 (80.0)      40 (80.0)             </span></span>
<span><span class="co">#&gt;      Occas               11 ( 8.1)       4 ( 8.0)       4 ( 8.0)             </span></span>
<span><span class="co">#&gt;      Regul                9 ( 6.6)       4 ( 8.0)       4 ( 8.0)             </span></span>
<span><span class="co">#&gt;   Pulse (mean (SD))   74.16 (9.95)   74.47 (4.87)   74.02 (16.55)  0.991     </span></span>
<span><span class="co">#&gt;   Height (mean (SD)) 172.46 (11.06) 172.48 (8.54)  171.93 (5.16)   0.962     </span></span>
<span><span class="co">#&gt;   Age (mean (SD))     20.30 (6.18)   20.51 (5.84)   20.45 (7.86)   0.976</span></span></code></pre></div>
<p>This looks much better! Still, the pulse variable seems to produce
some weird results with a diversity-based objective, so we may again
prefer the <em>k</em>-plus objective, which is also adequate for
unequal-group sizes:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">survey</span><span class="op">$</span><span class="va">House8</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anticlustering.html">anticlustering</a></span><span class="op">(</span></span>
<span>  <span class="va">survey</span><span class="op">[</span>, <span class="va">features</span><span class="op">]</span>, </span>
<span>  K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">137</span>, <span class="fl">50</span>, <span class="fl">50</span><span class="op">)</span>,</span>
<span>  standardize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"local-maximum"</span>,</span>
<span>  repetitions <span class="op">=</span> <span class="fl">10</span>, </span>
<span>  objective <span class="op">=</span> <span class="st">"kplus"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tableone/man/CreateTableOne.html" class="external-link">CreateTableOne</a></span><span class="op">(</span><span class="va">features</span>, strata <span class="op">=</span> <span class="st">"House8"</span>, data <span class="op">=</span> <span class="va">survey</span><span class="op">)</span></span>
<span><span class="co">#&gt;                     Stratified by House8</span></span>
<span><span class="co">#&gt;                      1              2              3              p      test</span></span>
<span><span class="co">#&gt;   n                     137             50             50                    </span></span>
<span><span class="co">#&gt;   Sex = Male (%)         68 (49.6)      25 (50.0)      25 (51.0)   0.986     </span></span>
<span><span class="co">#&gt;   W.Hnd = Right (%)     127 (92.7)      46 (92.0)      45 (91.8)   0.975     </span></span>
<span><span class="co">#&gt;   Exer (%)                                                         0.992     </span></span>
<span><span class="co">#&gt;      Freq                67 (48.9)      24 (48.0)      24 (48.0)             </span></span>
<span><span class="co">#&gt;      None                13 ( 9.5)       5 (10.0)       6 (12.0)             </span></span>
<span><span class="co">#&gt;      Some                57 (41.6)      21 (42.0)      20 (40.0)             </span></span>
<span><span class="co">#&gt;   Smoke (%)                                                        0.999     </span></span>
<span><span class="co">#&gt;      Heavy                6 ( 4.4)       2 ( 4.0)       3 ( 6.1)             </span></span>
<span><span class="co">#&gt;      Never              110 (80.3)      40 (80.0)      39 (79.6)             </span></span>
<span><span class="co">#&gt;      Occas               11 ( 8.0)       4 ( 8.0)       4 ( 8.2)             </span></span>
<span><span class="co">#&gt;      Regul               10 ( 7.3)       4 ( 8.0)       3 ( 6.1)             </span></span>
<span><span class="co">#&gt;   Pulse (mean (SD))   74.22 (11.44)  73.94 (13.19)  74.25 (9.50)   0.989     </span></span>
<span><span class="co">#&gt;   Height (mean (SD)) 172.39 (10.34) 172.24 (9.63)  172.55 (7.77)   0.991     </span></span>
<span><span class="co">#&gt;   Age (mean (SD))     20.27 (4.70)   20.20 (5.31)   20.83 (10.58)  0.854</span></span></code></pre></div>
<p>It seems that now the age variable suffers from differences in
standard deviations, albeit to a lesser degree than the pulse variable
when using the average diversity objective. Solving this issue is not
trivial. When inspecting the variable, we find out that it is highly
skewed with 2 outliers of age &gt; 70:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">survey</span><span class="op">$</span><span class="va">Age</span><span class="op">)</span></span></code></pre></div>
<p><img src="Anticlustering_in_2025_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">survey</span><span class="op">$</span><span class="va">Age</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span>
<span><span class="co">#&gt;  [1] 73.000 70.417 44.250 43.833 41.583 39.750 36.583 35.833 35.500 32.750</span></span></code></pre></div>
<p>We can try to enforce passing these two students to different houses.
This can be done by creating a new categorical variable encoding if a
student is an outlier regarding age. This variable can be passed to the
<code>categories</code> argument. The <code>categories</code> argument
implements hard constraints on the assignment of categorical
variables.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">survey</span><span class="op">$</span><span class="va">is_age_outlier</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">survey</span><span class="op">$</span><span class="va">Age</span> <span class="op">&gt;</span> <span class="fl">70</span><span class="op">)</span></span>
<span><span class="va">survey</span><span class="op">$</span><span class="va">House9</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anticlustering.html">anticlustering</a></span><span class="op">(</span></span>
<span>  <span class="va">survey</span><span class="op">[</span>, <span class="va">features</span><span class="op">]</span>, </span>
<span>  K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">137</span>, <span class="fl">50</span>, <span class="fl">50</span><span class="op">)</span>,</span>
<span>  standardize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"local-maximum"</span>,</span>
<span>  repetitions <span class="op">=</span> <span class="fl">10</span>, </span>
<span>  objective <span class="op">=</span> <span class="st">"kplus"</span>,</span>
<span>  categories <span class="op">=</span> <span class="va">survey</span><span class="op">$</span><span class="va">is_age_outlier</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tableone/man/CreateTableOne.html" class="external-link">CreateTableOne</a></span><span class="op">(</span><span class="va">features</span>, strata <span class="op">=</span> <span class="st">"House9"</span>, data <span class="op">=</span> <span class="va">survey</span><span class="op">)</span></span>
<span><span class="co">#&gt;                     Stratified by House9</span></span>
<span><span class="co">#&gt;                      1              2              3              p      test</span></span>
<span><span class="co">#&gt;   n                     137             50             50                    </span></span>
<span><span class="co">#&gt;   Sex = Male (%)         68 (49.6)      25 (50.0)      25 (51.0)   0.986     </span></span>
<span><span class="co">#&gt;   W.Hnd = Right (%)     127 (92.7)      46 (92.0)      45 (91.8)   0.975     </span></span>
<span><span class="co">#&gt;   Exer (%)                                                         0.890     </span></span>
<span><span class="co">#&gt;      Freq                68 (49.6)      24 (48.0)      23 (46.0)             </span></span>
<span><span class="co">#&gt;      None                12 ( 8.8)       5 (10.0)       7 (14.0)             </span></span>
<span><span class="co">#&gt;      Some                57 (41.6)      21 (42.0)      20 (40.0)             </span></span>
<span><span class="co">#&gt;   Smoke (%)                                                        0.970     </span></span>
<span><span class="co">#&gt;      Heavy                5 ( 3.6)       3 ( 6.0)       3 ( 6.1)             </span></span>
<span><span class="co">#&gt;      Never              112 (81.8)      39 (78.0)      38 (77.6)             </span></span>
<span><span class="co">#&gt;      Occas               10 ( 7.3)       4 ( 8.0)       5 (10.2)             </span></span>
<span><span class="co">#&gt;      Regul               10 ( 7.3)       4 ( 8.0)       3 ( 6.1)             </span></span>
<span><span class="co">#&gt;   Pulse (mean (SD))   74.29 (11.60)  73.82 (12.89)  73.90 (6.10)   0.969     </span></span>
<span><span class="co">#&gt;   Height (mean (SD)) 172.42 (10.34) 172.39 (8.31)  172.24 (9.48)   0.995     </span></span>
<span><span class="co">#&gt;   Age (mean (SD))     20.26 (5.01)   20.14 (7.93)   20.91 (8.31)   0.800</span></span></code></pre></div>
<p>The age outliers are now assigned to different houses, which was not
the case with our previous assignment:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">survey</span><span class="op">$</span><span class="va">is_age_outlier</span>, <span class="va">survey</span><span class="op">$</span><span class="va">House9</span><span class="op">)</span> <span class="co"># new assignment using `categories` argument</span></span>
<span><span class="co">#&gt;        </span></span>
<span><span class="co">#&gt;           1   2   3</span></span>
<span><span class="co">#&gt;   FALSE 137  49  49</span></span>
<span><span class="co">#&gt;   TRUE    0   1   1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">survey</span><span class="op">$</span><span class="va">is_age_outlier</span>, <span class="va">survey</span><span class="op">$</span><span class="va">House8</span><span class="op">)</span> <span class="co"># old assignment not using `categories` argument</span></span>
<span><span class="co">#&gt;        </span></span>
<span><span class="co">#&gt;           1   2   3</span></span>
<span><span class="co">#&gt;   FALSE 137  50  48</span></span>
<span><span class="co">#&gt;   TRUE    0   0   2</span></span></code></pre></div>
<p>In total, I think the the results are now slightly improved due to
enforcing to balance the age outliers. Still, with an uneven
distribution as observed here for age, creating similar (unequal-sized!)
groups with regard to many variables is not a trivial issue. It really
is quite a difficult problem; anticlustering is our best shot at solving
it satisfactorily nevertheless. However, anticlustering cannot solve
issues with the data themselves.</p>
</div>
</div>
<div class="section level2">
<h2 id="further-reading">Further reading<a class="anchor" aria-label="anchor" href="#further-reading"></a>
</h2>
<p>If you require some theoretical background on the stuff discussed
here, here you go:</p>
<div class="section level3">
<h3 id="categorical-variables">Categorical variables<a class="anchor" aria-label="anchor" href="#categorical-variables"></a>
</h3>
<p>In the original introduction of the <code>anticlust</code> package
(Papenberg and Klau, 2021), we introduced the handling of categorical
variables as hard constraints via the <code>categories</code> argument.
In Papenberg, Wang., et al. (2025), we discussed using binary (“one
hot”) encoding for categorical variables and using them as part of the
optimization criterion (i.e., the first argument in
<code><a href="../reference/anticlustering.html">anticlustering()</a></code>).</p>
</div>
<div class="section level3">
<h3 id="objectives">Objectives<a class="anchor" aria-label="anchor" href="#objectives"></a>
</h3>
<p>The diversity objective has long been known in the context of
anticlustering and cluster analysis. The <em>k</em>-plus criterion was
presented in Papenberg (2024), and the average diversity was discussed
in Papenberg, Breuer, et al. (2025), where the term average diversity
was first employed. The objective was also used by Mohebi et al. (2022).
I am not aware of other earlier usages in the context of anticlustering
applications.</p>
</div>
<div class="section level3">
<h3 id="algorithms">Algorithms<a class="anchor" aria-label="anchor" href="#algorithms"></a>
</h3>
<p>The default anticlustering algorithm method = “exchange” was
described in Papenberg and Klau (2021). However, this algorithm is
actually just a shorter version of the local maximum method (i.e.,
method = “local-maximum”), which corresponds to the algorithm “LCW” by
Weitz and Lakshminarayanan (1996, 1998). The three phase search
algorithm for anticlustering was presented by Yang et al. (2022). For
<code>anticlust</code>, we implemented some changes of their default
procedure, in particular they used a maximum “time” that the algorithm
runs before terminating. For consistency with our other methods in
<code>anticlust</code>, we are however using a maximum number of
“repetitions”. Our default is 50 repetitions, which may be increased
(but not decreased!) with the <code>repetitions</code> argument in
<code><a href="../reference/anticlustering.html">anticlustering()</a></code>. This adaptation was described and
evaluated by Hengelbrock (2024).</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Hengelbrock, H. (2024). <em>Evaluating the three-phase search
approach with dynamic population size for anticlustering</em>.
Unpublished bachelor thesis.</p>
<p>Mohebi, S., Zanella, A., &amp; Zorzi, M. (2022). <em>Pilot reuse in
cell-free massive MIMO systems: A diverse clustering approach</em>.
arXiv. <a href="https://doi.org/10.48550/arXiv.2212.08872" class="external-link uri">https://doi.org/10.48550/arXiv.2212.08872</a></p>
<p>Papenberg, M. (2024). K-plus Anticlustering: An Improved k-means
Criterion for Maximizing Between-Group Similarity. <em>British Journal
of Mathematical and Statistical Psychology, 77</em> (1), 80–102. <a href="https://doi.org/10.1111/bmsp.12315" class="external-link uri">https://doi.org/10.1111/bmsp.12315</a></p>
<p>Papenberg, M., &amp; Klau, G. W. (2021). Using anticlustering to
partition data sets into equivalent parts. <em>Psychological Methods,
26</em>(2), 161–174. <a href="https://doi.org/10.1037/met0000301" class="external-link uri">https://doi.org/10.1037/met0000301</a></p>
<p>Papenberg, M., Wang, C., Diop, M., Bukhari, S. H., Oskotsky, B.,
Davidson, B. R., … &amp; Oskotsky, T. T. (2025). Anticlustering for
sample allocation to minimize batch effects. <em>Cell Reports Methods,
5</em>(8). <a href="https://doi.org/10.1016/j.crmeth.2025.101137" class="external-link uri">https://doi.org/10.1016/j.crmeth.2025.101137</a></p>
<p>Papenberg, M., Breuer, M., Diekhoff, M., Tran, N. K., &amp; Klau, G.
W. (2025). Extending the Bicriterion Approach for Anticlustering: Exact
and Hybrid Approaches. Psychometrika. Advance online publication. <a href="https://doi.org/10.1017/psy.2025.10052" class="external-link uri">https://doi.org/10.1017/psy.2025.10052</a></p>
<p>Weitz, R. R., &amp; Lakshminarayanan, S. (1996). On a heuristic for
the final exam scheduling problem. <em>Journal of the Operational
Research Society, 47</em>(4), 599–600.</p>
<p>Weitz, R. R., &amp; Lakshminarayanan, S. (1998). An empirical
comparison of heuristic methods for creating maximally diverse groups.
<em>Journal of the Operational Research Society, 49</em>(6), 635–646. <a href="https://doi.org/10.1057/palgrave.jors.2600510" class="external-link uri">https://doi.org/10.1057/palgrave.jors.2600510</a></p>
<p>Yang, X., Cai, Z., Jin, T., Tang, Z., &amp; Gao, S. (2022). A
three-phase search approach with dynamic population size for solving the
maximally diverse grouping problem. <em>European Journal of Operational
Research, 302</em>(3), 925–953. <a href="https://doi.org/10.1016/j.ejor.2022.02.003" class="external-link uri">https://doi.org/10.1016/j.ejor.2022.02.003</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Martin Papenberg.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
